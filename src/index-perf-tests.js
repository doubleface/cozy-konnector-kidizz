/* SET DEBUG ENVIRONEMNT VARIABLE TO FALSE TO AVOID LOGS FROM THE EXIF LIB */
process.env['DEBUG'] = true

filesIds = [
  '44a682c90a14fa87f2269cb24814d930',
  '44a682c90a14fa87f2269cb24814dd76',
  '44a682c90a14fa87f2269cb248149139',
  '44a682c90a14fa87f2269cb24814c54c',
  '44a682c90a14fa87f2269cb24814b50d',
  '44a682c90a14fa87f2269cb24801f45a',
  '44a682c90a14fa87f2269cb248125221',
  '44a682c90a14fa87f2269cb248123656',
  '44a682c90a14fa87f2269cb248121dc9',
  '44a682c90a14fa87f2269cb248017254',
  '44a682c90a14fa87f2269cb2480137d0',
  '44a682c90a14fa87f2269cb248015ee7',
  '44a682c90a14fa87f2269cb2480153f2',
  '44a682c90a14fa87f2269cb248011659',
  '44a682c90a14fa87f2269cb248019d3d',
  '44a682c90a14fa87f2269cb24811c74f',
  '44a682c90a14fa87f2269cb24811e1b6',
  '44a682c90a14fa87f2269cb24802a628',
  '44a682c90a14fa87f2269cb248027a15',
  '44a682c90a14fa87f2269cb24802409d',
  '44a682c90a14fa87f2269cb248026e18',
  '44a682c90a14fa87f2269cb248025644',
  '44a682c90a14fa87f2269cb24804055f',
  '44a682c90a14fa87f2269cb24803e677',
  '44a682c90a14fa87f2269cb24803ad19',
  '44a682c90a14fa87f2269cb2480398f3',
  '44a682c90a14fa87f2269cb24803c886',
  '44a682c90a14fa87f2269cb24803563e',
  '44a682c90a14fa87f2269cb248038356',
  '44a682c90a14fa87f2269cb24803146e',
  '44a682c90a14fa87f2269cb24803353c',
  '44a682c90a14fa87f2269cb2480339a7',
  '44a682c90a14fa87f2269cb24803063b',
  '44a682c90a14fa87f2269cb24802f74b',
  '44a682c90a14fa87f2269cb24802b69a',
  '44a682c90a14fa87f2269cb2480453ca',
  '44a682c90a14fa87f2269cb248042dc5',
  '44a682c90a14fa87f2269cb248044017',
  '44a682c90a14fa87f2269cb248041def',
  '44a682c90a14fa87f2269cb24804b0b5',
  '44a682c90a14fa87f2269cb2480475ab',
  '44a682c90a14fa87f2269cb24804993d',
  '44a682c90a14fa87f2269cb248048748',
  '44a682c90a14fa87f2269cb2480468c7',
  '44a682c90a14fa87f2269cb2480613d6',
  '44a682c90a14fa87f2269cb24805f8eb',
  '44a682c90a14fa87f2269cb24805e057',
  '44a682c90a14fa87f2269cb24805b5db',
  '44a682c90a14fa87f2269cb24805a244',
  '44a682c90a14fa87f2269cb248058523',
  '44a682c90a14fa87f2269cb248057822',
  '44a682c90a14fa87f2269cb248054ff1',
  '44a682c90a14fa87f2269cb248051bf3',
  '44a682c90a14fa87f2269cb248053c05',
  '44a682c90a14fa87f2269cb24804fd4e',
  '44a682c90a14fa87f2269cb24804db70',
  '44a682c90a14fa87f2269cb248072579',
  '44a682c90a14fa87f2269cb248074352',
  '44a682c90a14fa87f2269cb24806fdb1',
  '44a682c90a14fa87f2269cb24806f3c6',
  '44a682c90a14fa87f2269cb24806e53f',
  '44a682c90a14fa87f2269cb24806d21e',
  '44a682c90a14fa87f2269cb24806b758',
  '44a682c90a14fa87f2269cb24806ab46',
  '44a682c90a14fa87f2269cb248069058',
  '44a682c90a14fa87f2269cb2480671d7',
  '44a682c90a14fa87f2269cb2480664c9',
  '44a682c90a14fa87f2269cb248065662',
  '44a682c90a14fa87f2269cb2480634c4',
  '44a682c90a14fa87f2269cb248087e31',
  '44a682c90a14fa87f2269cb248089680',
  '44a682c90a14fa87f2269cb248086ca0',
  '44a682c90a14fa87f2269cb248080f44',
  '44a682c90a14fa87f2269cb2480847e6',
  '44a682c90a14fa87f2269cb248082b47',
  '44a682c90a14fa87f2269cb24807f0ca',
  '44a682c90a14fa87f2269cb24807dc1e',
  '44a682c90a14fa87f2269cb24807c049',
  '44a682c90a14fa87f2269cb24807d1e7',
  '44a682c90a14fa87f2269cb24807973c',
  '44a682c90a14fa87f2269cb248077de5',
  '44a682c90a14fa87f2269cb24807a958',
  '44a682c90a14fa87f2269cb248075703',
  '44a682c90a14fa87f2269cb24807355b',
  '44a682c90a14fa87f2269cb248091257',
  '44a682c90a14fa87f2269cb24808e9b3',
  '44a682c90a14fa87f2269cb24808d8e5',
  '44a682c90a14fa87f2269cb24808f9e4',
  '44a682c90a14fa87f2269cb24808ad54',
  '44a682c90a14fa87f2269cb248093e48',
  '44a682c90a14fa87f2269cb248092a13',
  '44a682c90a14fa87f2269cb24809e37a',
  '44a682c90a14fa87f2269cb2480976cb',
  '44a682c90a14fa87f2269cb248099228',
  '44a682c90a14fa87f2269cb24809a4a8',
  '44a682c90a14fa87f2269cb2480953e3',
  '44a682c90a14fa87f2269cb2480a1f0f',
  '44a682c90a14fa87f2269cb2480a3aa8',
  '44a682c90a14fa87f2269cb2480a4339',
  '44a682c90a14fa87f2269cb24809fd07',
  '44a682c90a14fa87f2269cb24809d232',
  '44a682c90a14fa87f2269cb24809ee7b',
  '44a682c90a14fa87f2269cb2480b27ab',
  '44a682c90a14fa87f2269cb2480adab3',
  '44a682c90a14fa87f2269cb2480ac912',
  '44a682c90a14fa87f2269cb2480a7f5d',
  '44a682c90a14fa87f2269cb2480a5025',
  '44a682c90a14fa87f2269cb2480aa28d',
  '44a682c90a14fa87f2269cb2480a756d',
  '44a682c90a14fa87f2269cb2480cf50e',
  '44a682c90a14fa87f2269cb2480ca570',
  '44a682c90a14fa87f2269cb2480c8970',
  '44a682c90a14fa87f2269cb2480c7454',
  '44a682c90a14fa87f2269cb2480c464c',
  '44a682c90a14fa87f2269cb2480c69d6',
  '44a682c90a14fa87f2269cb2480c1f18',
  '44a682c90a14fa87f2269cb2480c0f82',
  '44a682c90a14fa87f2269cb2480b7f8d',
  '44a682c90a14fa87f2269cb2480b9e32',
  '44a682c90a14fa87f2269cb2480b3de8',
  '44a682c90a14fa87f2269cb2480b4e12',
  '44a682c90a14fa87f2269cb2480b619e',
  '44a682c90a14fa87f2269cb2480b0185',
  '44a682c90a14fa87f2269cb2480bbd6b',
  '44a682c90a14fa87f2269cb2480bd855',
  '44a682c90a14fa87f2269cb2480bef44',
  '44a682c90a14fa87f2269cb2480d735b',
  '44a682c90a14fa87f2269cb2480d5c7b',
  '44a682c90a14fa87f2269cb2480d65d7',
  '44a682c90a14fa87f2269cb2480d4edc',
  '44a682c90a14fa87f2269cb2480d1c29',
  '44a682c90a14fa87f2269cb2480d0dee',
  '44a682c90a14fa87f2269cb2480d00e6',
  '44a682c90a14fa87f2269cb2480ccb14',
  '44a682c90a14fa87f2269cb2480cdf99',
  '44a682c90a14fa87f2269cb2480f410b',
  '44a682c90a14fa87f2269cb2480f2869',
  '44a682c90a14fa87f2269cb2480eed43',
  '44a682c90a14fa87f2269cb2480ec77f',
  '44a682c90a14fa87f2269cb2480efd11',
  '44a682c90a14fa87f2269cb2480eda68',
  '44a682c90a14fa87f2269cb2480ea08c',
  '44a682c90a14fa87f2269cb2480e6f77',
  '44a682c90a14fa87f2269cb2480e8158',
  '44a682c90a14fa87f2269cb2480e6b6c',
  '44a682c90a14fa87f2269cb2480e49cf',
  '44a682c90a14fa87f2269cb2480e5e3b',
  '44a682c90a14fa87f2269cb2480e06ef',
  '44a682c90a14fa87f2269cb2480dd865',
  '44a682c90a14fa87f2269cb2480dee1f',
  '44a682c90a14fa87f2269cb2480dd369',
  '44a682c90a14fa87f2269cb2480dba2a',
  '44a682c90a14fa87f2269cb2480d87f9',
  '44a682c90a14fa87f2269cb24810584f',
  '44a682c90a14fa87f2269cb248103c88',
  '44a682c90a14fa87f2269cb24810447c',
  '44a682c90a14fa87f2269cb248100f12',
  '44a682c90a14fa87f2269cb248101a9d',
  '44a682c90a14fa87f2269cb2480fea40',
  '44a682c90a14fa87f2269cb2480fda75',
  '44a682c90a14fa87f2269cb2480fb302',
  '44a682c90a14fa87f2269cb2480fce6a',
  '44a682c90a14fa87f2269cb2480f778d',
  '44a682c90a14fa87f2269cb2480f8a51',
  '44a682c90a14fa87f2269cb2480f64f7',
  '44a682c90a14fa87f2269cb2480f5b00',
  '44a682c90a14fa87f2269cb2480f48a2',
  '44a682c90a14fa87f2269cb2481094ab',
  '44a682c90a14fa87f2269cb248107a00',
  '44a682c90a14fa87f2269cb24810b5f8',
  '44a682c90a14fa87f2269cb2481069c5',
  '44a682c90a14fa87f2269cb248104b94',
  '44a682c90a14fa87f2269cb248002606',
  '44a682c90a14fa87f2269cb24800337e',
  '44a682c90a14fa87f2269cb248004280',
  '44a682c90a14fa87f2269cb248004e3d',
  '44a682c90a14fa87f2269cb248009752',
  '44a682c90a14fa87f2269cb24800b3e8',
  '44a682c90a14fa87f2269cb248007afe',
  '44a682c90a14fa87f2269cb24800a533',
  '44a682c90a14fa87f2269cb2480069d5',
  '44a682c90a14fa87f2269cb248008603',
  '44a682c90a14fa87f2269cb2481127d2',
  '44a682c90a14fa87f2269cb248110914'
]

/* GLOBALS */
const Promise = require('bluebird')
const path = require('path')
var { BaseKonnector, cozyClient, log } = require('cozy-konnector-libs')

module.exports = new BaseKonnector(start)

async function start(fields) {
  let existingImgDoc
  var hrstart = process.hrtime()
  var n = 100

  for (var i = 0; i < n; i++) {
    existingImgDoc = await cozyClient.files.statById(
      '44a682c90a14fa87f2269cb24811c74f'
    )
    // log('debug', i + ' ' + !!existingImgDoc)
  }
  var hrend = process.hrtime(hrstart)
  var dur = hrend[0] * 1000000000 + hrend[1] // in nano secondes
  console.log(hrend[0], hrend[1])
  console.log(
    `durée moyenne en appelant ${n} fois sur un meme fichier ${dur /
      n /
      1000000}  millisecondes`
  )

  hrstart = process.hrtime()
  for (let id of filesIds) {
    existingImgDoc = await cozyClient.files.statById(id)
    // log('debug', id + ' ' + !!existingImgDoc)
  }
  hrend = process.hrtime(hrstart)
  dur = hrend[0] * 1000000000 + hrend[1] // in nano secondes
  console.log(hrend[0], hrend[1])
  n = filesIds.length
  console.log(
    `durée moyenne en appelant sur ${n} fichier distincts " + ${dur /
      n /
      1000000} millisecondes`
  )
  console.log(
    `durée totale  en appelant sur ${n} fichier distincts " + ${dur /
      1000000 /
      1000} secondes`
  )

  // let dirDoc = await cozyClient.files.statById('44a682c90a14fa87f2269cb248001d99',false, {limit:1000})
  // console.log(dirDoc);
  // dirDoc.relations('contents').forEach( (file) => console.log(file._id) )
}
